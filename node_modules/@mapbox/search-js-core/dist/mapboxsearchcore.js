var mapboxsearchcore=(()=>{var I=Object.defineProperty,Ue=Object.defineProperties,Ge=Object.getOwnPropertyDescriptor,$e=Object.getOwnPropertyDescriptors,Ne=Object.getOwnPropertyNames,j=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var pe=(o,e,t)=>e in o?I(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,g=(o,e)=>{for(var t in e||(e={}))te.call(e,t)&&pe(o,t,e[t]);if(j)for(var t of j(e))me.call(e,t)&&pe(o,t,e[t]);return o},x=(o,e)=>Ue(o,$e(e)),je=o=>I(o,"__esModule",{value:!0});var w=(o,e)=>{var t={};for(var r in o)te.call(o,r)&&e.indexOf(r)<0&&(t[r]=o[r]);if(o!=null&&j)for(var r of j(o))e.indexOf(r)<0&&me.call(o,r)&&(t[r]=o[r]);return t};var Ie=(o,e)=>{for(var t in e)I(o,t,{get:e[t],enumerable:!0})},Ve=(o,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Ne(e))!te.call(o,s)&&(t||s!=="default")&&I(o,s,{get:()=>e[s],enumerable:!(r=Ge(e,s))||r.enumerable});return o};var qe=(o=>(e,t)=>o&&o.get(e)||(t=Ve(je({}),e,1),o&&o.set(e,t),t))(typeof WeakMap!="undefined"?new WeakMap:0);var re=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var p=(o,e,t)=>(re(o,e,"read from private field"),t?t.call(o):e.get(o)),m=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)},L=(o,e,t,r)=>(re(o,e,"write to private field"),r?r.call(o,t):e.set(o,t),t),de=(o,e,t,r)=>({set _(s){L(o,e,s,t)},get _(){return p(o,e,r)}}),v=(o,e,t)=>(re(o,e,"access private method"),t);var d=(o,e,t)=>new Promise((r,s)=>{var n=c=>{try{a(t.next(c))}catch(u){s(u)}},i=c=>{try{a(t.throw(c))}catch(u){s(u)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(n,i);a((t=t.apply(o,e)).next())});var ot={};Ie(ot,{AddressAutofillCore:()=>D,Evented:()=>U,GeocodingCore:()=>ae,LngLat:()=>l,LngLatBounds:()=>S,MapboxAutofill:()=>D,MapboxError:()=>V,MapboxGeocode:()=>ae,MapboxValidate:()=>z,MatchCodeConfidence:()=>ce,MatchCodeType:()=>ge,SearchBoxCore:()=>W,SearchSession:()=>le,SessionToken:()=>h,ValidationCore:()=>z,debounce:()=>Z,featureToSuggestion:()=>Pe,polyfillFetch:()=>xe});var fe="https://api.mapbox.com/autofill/v1",De="suggest",Me="retrieve",he=`${fe}/${De}`,Se=`${fe}/${Me}`;var l=class{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90");if(this.lng>180||this.lng<-180)throw new Error("Invalid LngLat longitude value: must be between -180 and 180")}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}static convert(e){if(e instanceof l)return new l(e.lng,e.lat);if(Array.isArray(e)&&e.length===2)return new l(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null&&("lng"in e||"lon"in e)&&"lat"in e)return new l(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};var S=class{constructor(e,t){this._sw=l.convert(e),this._ne=l.convert(t)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l(this.getWest(),this.getNorth())}getSouthEast(){return new l(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toFlatArray(){return[this._sw.lng,this._sw.lat,this._ne.lng,this._ne.lat]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}static convert(e){if(!e)throw new Error("Invalid LngLatBounds convert value: falsy");if(e instanceof S)return new S(e.getSouthWest(),e.getNorthEast());if(Array.isArray(e)&&e.length===2)return new S(l.convert(e[0]),l.convert(e[1]));if(Array.isArray(e)&&e.length===4)return new S(l.convert([e[0],e[1]]),l.convert([e[2],e[3]]));throw new Error("`LngLatBoundsLike` argument must be specified as an array [<LngLatLike>, <LngLatLike>] or an array [<west>, <south>, <east>, <north>]")}};function ye(){let e=(Math.random().toString(16)+Date.now().toString(16)+Math.random().toString(16)).replace(/\./g,"");return[e.slice(0,8),e.slice(8,12),"4"+e.slice(12,15)+"-8"+e.slice(15,18),e.slice(18,30)].join("-")}var h=class{constructor(e){this.id=e!=null?e:ye()}toString(){return this.id}static convert(e){return new h(e instanceof h?e.id:e.toString())}};var Qe="Unknown error",V=class extends Error{constructor(e,t){super(String(e.message||e.error||Qe));this.name="MapboxError",this.statusCode=t}toString(){return`${this.name} (${this.statusCode}): ${this.message}`}};function k(o){return d(this,null,function*(){if(!o.ok){let e=yield o.json();throw new V(e,o.status)}})}var q=globalThis.fetch,Re=globalThis.AbortController;function xe({fetch:o,AbortController:e},t=!1){if(!o)throw new Error("Fetch implementation must include implementations of `fetch`.");q&&!t||(q=o,Re=e)}function R(){if(!q)throw new Error("Fetch implementation not found. Please include a fetch polyfill in your application or use `polyfillFetch` from `@mapbox/search-js-core` to fix this issue.");return{fetch:q,AbortController:Re}}function T(...o){let e=[];for(let t of o){if(!t)continue;let r=Object.entries(t);for(let[s,n]of r)n!=null&&e.push(`${s}=${encodeURIComponent(String(n))}`)}return e.join("&")}var P,M,He,oe=class{constructor(e={}){m(this,M);m(this,P,void 0);let s=e,{accessToken:t}=s,r=w(s,["accessToken"]);this.accessToken=t,this.defaults=g(g({},oe.defaults),r)}get responseHeaders(){return p(this,P)}suggest(e,t){return d(this,null,function*(){if(!e)throw new Error("searchText is required");let{sessionToken:r,signal:s}=t,n=x(g(g({},this.defaults),t),{sessionToken:r}),i=new URL(`${he}/${encodeURIComponent(e)}`);i.search=v(this,M,He).call(this,n);let{fetch:a}=R(),c=yield a(i.toString(),{signal:s});L(this,P,c.headers),yield k(c);let u=yield c.json();return x(g({},u),{suggestions:u.suggestions.map(f=>x(g({},f),{original_search_text:e,_source:"mapbox"})),url:i.toString()})})}retrieve(e,t){return d(this,null,function*(){if(!e)throw new Error("suggestion is required");if(!this.canRetrieve(e))throw new Error("suggestion cannot be retrieved");let{sessionToken:r,signal:s}=t,n=h.convert(r),i=new URL(`${Se}/${e.action.id}`);i.search=T({access_token:this.accessToken,session_token:n.id});let{fetch:a}=R(),c=yield a(i.toString(),{signal:s});yield k(c);let u=yield c.json();return u.url=i.toString(),u})}canRetrieve(e){let t=e.action;return typeof(t==null?void 0:t.id)=="string"}},D=oe;P=new WeakMap,M=new WeakSet,He=function(e){return T({types:"address",access_token:this.accessToken,streets:e.streets,language:e.language,country:e.country,limit:e.limit},e.sessionToken&&{session_token:h.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:l.convert(e.proximity).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:S.convert(e.bbox).toFlatArray().join(",")})},D.defaults={language:"en",proximity:"ip",streets:!0};var Q="https://api.mapbox.com/search/searchbox/v1",Ke="suggest",We="retrieve",Xe="category",Ye="reverse",Le=`${Q}/${Ke}`,be=`${Q}/${We}`,ke=`${Q}/${Xe}`,ve=`${Q}/${Ye}`;var Ae="\\.\\d{1,256}",ze=`\\d{1,3}(${Ae})?`,Te=`(-?(${ze}|${Ae}))`,H=new RegExp(`^[ ]*${Te},\\s*${Te}[ ]*$`),K=/[\s,]+/;var B,we,X,Je,Y,Ze,se=class{constructor(e={}){m(this,B);m(this,X);m(this,Y);let s=e,{accessToken:t}=s,r=w(s,["accessToken"]);this.accessToken=t,this.defaults=g(g({},se.defaults),r)}suggest(e,t){return d(this,null,function*(){var b;if(!e)throw new Error("searchText is required");if(H.test(e)&&t.allowReverse){let y=e.trim().split(K).map(Ce=>Ce.trim());t.flipCoordinates&&(y=y.reverse());let ee=y.join(","),Be=yield this.reverse(ee,t);return v(this,X,Je).call(this,Be)}let{sessionToken:s,signal:n}=t,i=x(g(g({},this.defaults),t),{q:e,sessionToken:s});if(i.eta_type&&(!i.origin||!i.navigation_profile))throw new Error("to provide eta estimate: eta, navigation_profile, and origin are required");if(i.origin&&!i.navigation_profile)throw new Error("to provide distance estimate: both navigation_profile and origin are required");let a=new URL(Le);a.search=v(this,B,we).call(this,i);let{fetch:c}=R(),u=yield c(a.toString(),{signal:n});yield k(u);let f=yield u.json();return f.url=a.toString(),(b=f.suggestions)==null||b.forEach(y=>{y._source="mapbox"}),f})}retrieve(e,t){return d(this,null,function*(){if(!e)throw new Error("suggestion is required");if(e._originalFeature)return{type:"FeatureCollection",features:[e._originalFeature],url:e._originalUrl||""};if(e._geometry)return{type:"FeatureCollection",features:[{type:"Feature",properties:e,geometry:e._geometry}]};let{sessionToken:r,signal:s,language:n}=t,i=h.convert(r),a=g(g({},this.defaults),n&&{language:n}),c=new URL(`${be}/${encodeURIComponent(e.mapbox_id)}`);c.search=T({access_token:this.accessToken,session_token:i.id},{language:a.language});let{fetch:u}=R(),f=yield u(c.toString(),{signal:s});yield k(f);let b=yield f.json();return b.url=c.toString(),b})}category(r){return d(this,arguments,function*(e,t={}){if(!e)throw new Error("category is required");let s=g(g({},this.defaults),t),n=new URL(`${ke}/${encodeURIComponent(e)}`);n.search=v(this,B,we).call(this,s);let{fetch:i}=R(),a=yield i(n.toString(),{signal:s.signal});yield k(a);let c=yield a.json();return c.url=n.toString(),c})}reverse(r){return d(this,arguments,function*(e,t={}){var b;if(!e)throw new Error("lngLat is required");let[s,n]=typeof e=="string"?e.split(",").map(y=>parseFloat(y)):l.convert(e).toArray();if(isNaN(s)||isNaN(n))throw new Error("lngLat is required");let i=g(g({},this.defaults),t),a=new URL(ve);a.search=T({access_token:this.accessToken,language:i.language,limit:i.limit,longitude:s,latitude:n},i.types&&{types:typeof i.types=="string"?i.types:[...i.types].join(",")});let{fetch:c}=R(),u=yield c(a.toString(),{signal:i.signal});yield k(u);let f=yield u.json();return f.url=a.toString(),(b=f.features)==null||b.forEach(y=>{y._source="mapbox"}),f})}},W=se;B=new WeakSet,we=function(e){return T({q:e.q,access_token:this.accessToken,language:e.language,limit:e.limit,navigation_profile:e.navigation_profile,route:e.route,route_geometry:e.route_geometry,sar_type:e.sar_type,time_deviation:e.time_deviation,eta_type:e.eta_type,country:e.country,poi_category:e.poi_category,rich_metadata_provider:e.rich_metadata_provider,poi_category_exclusions:e.poi_category_exclusions},e.sessionToken&&{session_token:h.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:l.convert(e.proximity).toArray().join(",")},e.origin&&{origin:typeof e.origin=="string"?e.origin:l.convert(e.origin).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:S.convert(e.bbox).toFlatArray().join(",")},e.types&&{types:typeof e.types=="string"?e.types:[...e.types].join(",")})},X=new WeakSet,Je=function(e){return{suggestions:e.features.map(t=>v(this,Y,Ze).call(this,t,e.url)),attribution:e.attribution,url:e.url}},Y=new WeakSet,Ze=function(e,t){return x(g({},e.properties),{_originalFeature:e,_originalUrl:t,_source:e._source})},W.defaults={language:"en"};var et="https://api.mapbox.com/autofill/v1",tt="retrieve",Ee=`${et}/${tt}`;var J,rt,ne=class{constructor(e={}){m(this,J);let s=e,{accessToken:t}=s,r=w(s,["accessToken"]);this.accessToken=t,this.defaults=g(g({},ne.defaults),r)}validate(e,t){return d(this,null,function*(){if(!e)throw new Error("searchText is required");let{sessionToken:r,signal:s}=t,n=x(g(g({},this.defaults),t),{sessionToken:r}),i=new URL(`${Ee}/${encodeURIComponent(e)}`);i.search=v(this,J,rt).call(this,n);let{fetch:a}=R(),c=yield a(i.toString(),{signal:s});yield k(c);let u=yield c.json();return u.url=i.toString(),u.features.length>0&&(u.features=[u.features[0]]),u})}},z=ne;J=new WeakSet,rt=function(e){return T({access_token:this.accessToken,language:e.language,country:e.country},e.sessionToken&&{session_token:h.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:l.convert(e.proximity).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:S.convert(e.bbox).toFlatArray().join(",")})},z.defaults={language:"en",proximity:"ip"};var ie="https://api.mapbox.com/search/geocode/v6",Oe=`${ie}/forward`,_e=`${ie}/reverse`,Zt=`${ie}/batch`;var O,C,Fe,ae=class{constructor(e={}){m(this,C);m(this,O,void 0);let s=e,{accessToken:t}=s,r=w(s,["accessToken"]);this.accessToken=t,this.defaults=g({},r)}get responseHeaders(){return p(this,O)}forward(e,t){return d(this,null,function*(){var f;if(!e)throw new Error("searchText is required");let r;t&&({signal:r}=t);let s=x(g(g({},this.defaults),t),{q:e}),n=new URL(`${Oe}`);n.search=v(this,C,Fe).call(this,s);let{fetch:i}=R(),a=r?{signal:r}:{},c=yield i(n.toString(),a);L(this,O,c.headers),yield k(c);let u=yield c.json();return u.url=n.toString(),(f=u.features)==null||f.forEach(b=>{b._source="mapbox"}),u})}reverse(e,t){return d(this,null,function*(){var b;if(!e)throw new Error("lngLat is required");let r;t&&({signal:r}=t);let s;if(typeof e=="string"){let[y,ee]=e.split(",");s=new l(Number(y),Number(ee))}else s=l.convert(e);let n=x(g(g({},this.defaults),t),{longitude:s.lng,latitude:s.lat}),i=new URL(`${_e}`);i.search=v(this,C,Fe).call(this,n,!0);let{fetch:a}=R(),c=r?{signal:r}:{},u=yield a(i.toString(),c);L(this,O,u.headers),yield k(u);let f=yield u.json();return f.url=i.toString(),(b=f.features)==null||b.forEach(y=>{y._source="mapbox"}),f})}suggest(e,t){return d(this,null,function*(){if(H.test(e)){let s=e.trim().split(K).map(i=>i.trim());t.flipCoordinates&&(s=s.reverse());let n=s.join(",");return this.reverse(n,t)}else return this.forward(e,t)})}retrieve(e){return d(this,null,function*(){return e})}};O=new WeakMap,C=new WeakSet,Fe=function(e,t=!1){return t&&["proximity","autocomplete","bbox"].forEach(r=>{r in e&&delete e[r]}),T({q:e.q,longitude:e.longitude,latitude:e.latitude,access_token:this.accessToken,permanent:e.permanent,language:e.language,country:e.country,limit:e.limit,autocomplete:e.autocomplete,worldview:e.worldview},e.sessionToken&&{session_token:h.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:l.convert(e.proximity).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:S.convert(e.bbox).toFlatArray().join(",")},e.types&&{types:typeof e.types=="string"?e.types:[...e.types].join(",")})};var ge=(n=>(n.matched="matched",n.unmatched="unmatched",n.plausible="plausible",n.not_applicable="not_applicable",n.inferred="inferred",n))(ge||{}),ce=(s=>(s.exact="exact",s.high="high",s.medium="medium",s.low="low",s))(ce||{});var _,U=class{constructor(){m(this,_,{})}addEventListener(e,t){let r=p(this,_);r[e]||(r[e]=[]),r[e].push(t)}removeEventListener(e,t){let r=p(this,_);if(!r[e])return;let s=r[e],n=s.indexOf(t);n!==-1&&s.splice(n,1)}fire(e,t){let r=p(this,_);if(!r[e])return;let s=r[e];for(let n of s)n(t)}};_=new WeakMap;function Z(o,e,t){let r=null;return(...s)=>{r!==null&&clearTimeout(r);let n=t&&t();r=setTimeout(()=>{r=null,!(n==null?void 0:n.aborted)&&o(...s)},e)}}function ue(){let{AbortController:o}=R();return new o}var F,G,$,E,A,N,le=class extends U{constructor(e,t=0){super();m(this,F,new h);m(this,G,0);m(this,$,!1);m(this,E,void 0);m(this,A,ue());m(this,N,void 0);L(this,N,Z((n,...i)=>d(this,[n,...i],function*(r,s={}){if(p(this,A).abort(),L(this,A,ue()),!r){L(this,E,null),this.fire("suggest",p(this,E));return}try{let a=yield this.search.suggest(r,x(g({sessionToken:this.sessionToken},s),{signal:p(this,A).signal}));L(this,E,a),this.fire("suggest",a)}catch(a){if(a.name==="AbortError")return;this.fire("suggesterror",a)}}),t,()=>p(this,A).signal)),Object.defineProperties(this,{search:{value:e,writable:!1},debounce:{value:t,writable:!1}})}get sessionToken(){return p(this,$)?p(this,F).id:`${p(this,F).id}.${p(this,G)}`}set sessionToken(e){L(this,$,!0),L(this,F,new h(e))}get suggestions(){return p(this,E)}suggest(e,t){return p(this,N).call(this,e,t),new Promise((r,s)=>{let n,i;n=a=>{this.removeEventListener("suggest",n),this.removeEventListener("suggesterror",i),r(a)},i=a=>{this.removeEventListener("suggest",n),this.removeEventListener("suggesterror",i),s(a)},this.addEventListener("suggest",n),this.addEventListener("suggesterror",i)})}clear(){this.suggest("")}retrieve(e,t){return d(this,null,function*(){let r=yield this.search.retrieve(e,g({sessionToken:this.sessionToken},t));return this.fire("retrieve",r),r})}canRetrieve(e){return this.search.canRetrieve?this.search.canRetrieve(e):!0}canSuggest(e){return this.search.canSuggest?this.search.canSuggest(e):!0}abort(){p(this,A).abort(),L(this,A,ue())}incrementSession(){de(this,G)._++}};F=new WeakMap,G=new WeakMap,$=new WeakMap,E=new WeakMap,A=new WeakMap,N=new WeakMap;function Pe(o){let{properties:e}=o;return g({},e)}return qe(ot);})();
//# sourceMappingURL=mapboxsearchcore.js.map
